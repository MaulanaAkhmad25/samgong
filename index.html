<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>Game Kartu 30</title>
  <link
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
    rel="stylesheet"
  />
</head>
<body class="bg-light">

<div class="container mt-5">
  <div class="card shadow">
    <div class="card-body text-center">

      <h2 class="mb-4">ðŸŽ´ Game Kartu 30</h2>

      <div class="mb-3">
        <h5>Kartu User</h5>

        <div id="userCards" class="fw-bold d-flex justify-content-center"></div>

        <p>Total: <span id="userTotal">0</span></p>
      </div>

      <div class="mb-3">
        <h5>Kartu Bot</h5>
        <p>Total Bot: <span id="botTotal">?</span></p>
      </div>

      <div class="mb-3">
        <button id="startBtn" class="btn btn-primary">
          Mulai Main
        </button>
        <button id="addCardBtn" class="btn btn-warning d-none">
          Ambil Kartu
        </button>
        <button id="compareBtn" class="btn btn-success d-none">
          Bandingkan
        </button>
      </div>

      <div id="result" class="fs-4 fw-bold mt-3"></div>

    </div>
  </div>
</div>

<script>
  const startBtn = document.getElementById("startBtn");
  const addCardBtn = document.getElementById("addCardBtn");
  const compareBtn = document.getElementById("compareBtn");

  const userCardsEl = document.getElementById("userCards");
  const userTotalEl = document.getElementById("userTotal");
  const botTotalEl = document.getElementById("botTotal");
  const resultEl = document.getElementById("result");

  let userCards = [];
  let userTotal = 0;
  let botTotal = 0;

  function getRandomCardValue() {
    const cards = ["A", "2", "3", "4", "5", "6", "7", "8", "9", "10", "J", "Q", "K"];
    const suits = ["S", "H", "D", "C"];

    const card = cards[Math.floor(Math.random() * cards.length)];
    const suit = suits[Math.floor(Math.random() * suits.length)];

    let value = 0;
    if (card === "A") value = 11;
    else if (["J", "Q", "K"].includes(card)) value = 10;
    else value = parseInt(card);

    const image = `https://deckofcardsapi.com/static/img/${card}${suit}.png`;

    return { card, value, image };
  }

  function updateUserDisplay() {
    userCardsEl.innerHTML = "";

    userCards.forEach(c => {
      const img = document.createElement("img");
      img.src = c.image;
      img.width = 80;
      img.classList.add("me-2");
      userCardsEl.appendChild(img);
    });

    userTotalEl.textContent = userTotal;
  }

  /*
  function checkUserLose() {
    if (userTotal > 30) {
      resultEl.textContent = "Sayang sekali, tapi kamu Kalah";
      addCardBtn.classList.add("d-none");
      compareBtn.classList.add("d-none");
    }
  }
  */

  startBtn.addEventListener("click", () => {
    // reset
    userCards = [];
    userTotal = 0;
    resultEl.textContent = "";
    botTotalEl.textContent = "?";
    userCardsEl.innerHTML = "";

    // bot random dari awal
    botTotal = Math.floor(Math.random() * 21) + 20; // 0 - 40

    const firstCard = getRandomCardValue();

    userCards.push(firstCard);
    userTotal += firstCard.value;

    updateUserDisplay();

    startBtn.classList.add("d-none");
    addCardBtn.classList.remove("d-none");
    compareBtn.classList.remove("d-none");

    checkUserLose();
  });

  addCardBtn.addEventListener("click", () => {
    const newCard = getRandomCardValue();

    userCards.push(newCard);
    userTotal += newCard.value;

    updateUserDisplay();
    checkUserLose();
  });

  compareBtn.addEventListener("click", () => {
    botTotalEl.textContent = botTotal;

    if (botTotal > 30 && userTotal < botTotal) {
      resultEl.textContent = "Selamat, Kamu Menang!";
    } else if (userTotal < botTotal) {
      resultEl.textContent = "Sayang sekali, tapi kamu Kalah!";
    } else {
      resultEl.textContent = "Draw!";
    }

    addCardBtn.classList.add("d-none");
    compareBtn.classList.add("d-none");
  });
</script>

</body>
</html>
